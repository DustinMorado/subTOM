

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Conventions &mdash; subTOM 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial" href="tutorial.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> subTOM
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Conventions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#preprocessing">Preprocessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ctf-correction">CTF Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#particle-picking">Particle Picking</a></li>
<li class="toctree-l2"><a class="reference internal" href="#alignment-and-averaging">Alignment and Averaging</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#orientations">Orientations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#coordinate-system">Coordinate System</a></li>
<li class="toctree-l4"><a class="reference internal" href="#image-center">Image Center</a></li>
<li class="toctree-l4"><a class="reference internal" href="#euler-angle-rotations">Euler Angle Rotations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#translations">Translations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#motive-list-specification">Motive List Specification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#class-number">Class Number</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Links to Individual Script Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scripts/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_alignment.html">subtom_alignment.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_average.html">subtom_average.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_cat_motls.html">subtom_cat_motls.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_clean_motl.html">subtom_clean_motl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_compare_motls.html">subtom_compare_motls.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_even_odd_motl.html">subtom_even_odd_motl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_extract_noise.html">subtom_extract_noise.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_extract_subtomograms.html">subtom_extract_subtomograms.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_maskcorrected_fsc.html">subtom_maskcorrected_fsc.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_preprocess.html">subtom_preprocess.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_plot_filter.html">subtom_plot_filter.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_plot_scanned_angles.html">subtom_plot_scanned_angles.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_reconstruct.html">subtom_reconstruct.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_scale_motl.html">subtom_scale_motl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_seed_positions.html">subtom_seed_positions.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_shape.html">subtom_shape.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_split_motl_by_row.html">subtom_split_motl_by_row.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_transform_motl.html">subtom_transform_motl.sh</a></li>
</ul>
<p class="caption"><span class="caption-text">Links to Individual Function Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="functions/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_cat_motls.html">subtom_cat_motls.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_clean_motl.html">subtom_clean_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_compare_motls.html">subtom_compare_motls.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_even_odd_motl.html">subtom_even_odd_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_extract_noise.html">subtom_extract_noise.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_extract_subtomograms.html">subtom_extract_subtomograms.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_maskcorrected_fsc.html">subtom_maskcorrected_fsc.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_parallel_sums.html">subtom_parallel_sums.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_plot_filter.html">subtom_plot_filter.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_plot_scanned_angles.html">subtom_plot_scanned_angles.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_scale_motl.html">subtom_scale_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_scan_angles_exact.html">subtom_scan_angles_exact.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_seed_positions.html">subtom_seed_positions.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_shape.html">subtom_shape.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_split_motl_by_row.html">subtom_split_motl_by_row.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_transform_motl.html">subtom_transform_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/subtom_weighted_average.html">subtom_weighted_average.m</a></li>
</ul>
<p class="caption"><span class="caption-text">B-Factor by Subsets Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="functions/b_factor_by_subsets/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts/subtom_b_factor_by_subsets.html">subtom_b_factor_by_subsets.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/b_factor_by_subsets/subtom_maskcorrected_fsc.html">subtom_maskcorrected_fsc.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/b_factor_by_subsets/subtom_parallel_sums.html">subtom_parallel_sums.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="functions/b_factor_by_subsets/subtom_weighted_average.html">subtom_weighted_average.m</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">subTOM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Conventions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/conventions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="conventions">
<h1>Conventions<a class="headerlink" href="#conventions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this headline">¶</a></h2>
<p>Preprocessing is done for dose-fractionated data that comes from detectors that
collect movie tilt-images. Preprocessing is done with several programs from
various sources.</p>
<ul class="simple">
<li><p><strong>Beam-induced Motion Correction</strong></p>
<ul>
<li><p>The command <code class="docutils literal notranslate"><span class="pre">alignframes</span></code> <a class="reference external" href="https://bio3d.colorado.edu/imod/betaDoc/man/alignframes.html">alignframes man page</a> which is a
part of the <a class="reference external" href="http://bio3d.colorado.edu/imod/">IMOD</a> package is used to do the beam-induced motion correction
of the movies. subTOM assumes that the data is collected with <a class="reference external" href="http://bio3d.colorado.edu/SerialEM/">SerialEM</a>
but the program should support MRC and TIFF format movie-frames collected
with other programs as well. However this requires you to have your movies
to have the following name-scheme:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;BASENAME&gt;_&lt;FRAME_IDX&gt;_&lt;ANGLE&gt;.&lt;mrc|tif&gt;</span></code></p>
<ul>
<li><p>Where <code class="docutils literal notranslate"><span class="pre">&lt;BASENAME&gt;</span></code> is your own filename identifier <em>e.g. TS_01</em></p></li>
<li><p>Where <code class="docutils literal notranslate"><span class="pre">&lt;FRAME_IDX&gt;</span></code> is a three digit identifier of the movie that
describes the order the data was collected in <em>e.g. 000-040</em></p></li>
<li><p>Where <code class="docutils literal notranslate"><span class="pre">&lt;ANGLE&gt;</span></code> is the tilt-angle at which the movie was collected at
<em>e.g. 15.0</em></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Defocus Estimation</strong></p>
<ul>
<li><p>The programs <a class="reference external" href="http://grigoriefflab.janelia.org/ctffind4">CTFFIND4</a>, <a class="reference external" href="https://www.mrc-lmb.cam.ac.uk/kzhang/Gctf">GCTF</a>, and <a class="reference external" href="http://bio3d.colorado.edu/imod/">IMOD</a>’s <code class="docutils literal notranslate"><span class="pre">ctfplotter</span></code> <a class="reference external" href="https://bio3d.colorado.edu/imod/betaDoc/man/ctfplotter.html">ctfplotter
man page</a>
command can all be used to estimate the defocus in the corrected tilt-series</p></li>
</ul>
</li>
<li><p><strong>Dose Filtering</strong></p>
<ul>
<li><p>The command <code class="docutils literal notranslate"><span class="pre">alignframes</span></code> which is part of the <a class="reference external" href="http://bio3d.colorado.edu/imod/">IMOD</a> package is also
used to do the filtering of movies based on the accumulated dose of each
tilt-image.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="ctf-correction">
<h2>CTF Correction<a class="headerlink" href="#ctf-correction" title="Permalink to this headline">¶</a></h2>
<p>CTF correction is done in 3D using the program <a class="reference external" href="https://github.com/turonova/novaCTF">novaCTF</a>, and a run script
<code class="docutils literal notranslate"><span class="pre">run_nova.sh</span></code> is included to facilitate performing novaCTF in parallel and on
an SGE cluster.</p>
</div>
<div class="section" id="particle-picking">
<h2>Particle Picking<a class="headerlink" href="#particle-picking" title="Permalink to this headline">¶</a></h2>
<p>Particle picking is done using <a class="reference external" href="https://www.cgl.ucsf.edu/chimera/">UCSF Chimera</a>. First users use the built-in
<a class="reference external" href="https://www.cgl.ucsf.edu/chimera/docs/ContributedSoftware/volumepathtracer/framevolpath.html">Volume Tracer</a> utility to create a Marker Set of
points at the center of spherical particles onto which seed positions or a
collection of Marker Sets of points along tubular surfaces onto which seed
positions. The number of Marker Sets used is not important in picking points on
spheres, but in picking points on tubes, each tube should correspond to a single
Marker Set. The collection of Marker Sets should be saved to a single file, one
per tomogram with the name format:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;BASENAME&gt;_&lt;TOMOGRAM_IDX&gt;.cmm</span></code></p>
<ul>
<li><p>Where <code class="docutils literal notranslate"><span class="pre">&lt;BASENAME&gt;</span></code> is your own filename identifier <em>e.g. clicker</em>.</p></li>
<li><p>Where <code class="docutils literal notranslate"><span class="pre">&lt;TOMOGRAM_IDX&gt;</span></code> is the tomogram number <em>e.g. 1</em>.</p></li>
</ul>
</li>
</ul>
<p>Motive Lists are then generated for the picked objects using the <em>PickParticle</em>
plug-in developed in the Briggs’ lab by Kun Qu. The format of motive lists is
detailed below, and the motive list is assumed to saved to a single file, one
per tomogram with the name format:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;BASENAME&gt;_&lt;TOMOGRAM_IDX&gt;.em</span></code></p></li>
</ul>
</div>
<div class="section" id="alignment-and-averaging">
<h2>Alignment and Averaging<a class="headerlink" href="#alignment-and-averaging" title="Permalink to this headline">¶</a></h2>
<p>The alignment parameters for a set of data are stored in a MOTive List or
so-called MOTL file, which is a table of 20-fields stored in an EM-format binary
data file. Particles are also extracted into subvolumes in EM-format from
tomograms which are expected to be in MRC-format with the name:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;TOMOGRAM_IDX&gt;.rec</span></code></p></li>
</ul>
<div class="section" id="orientations">
<h3>Orientations<a class="headerlink" href="#orientations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="coordinate-system">
<h4>Coordinate System<a class="headerlink" href="#coordinate-system" title="Permalink to this headline">¶</a></h4>
<p>subTOM uses a right-handed coordinate system where positive rotations are
clockwise looking along the directed axis. The orthogonal axes X, Y, Z are with
the positive Z-axis pointing out of the screen out at the user.</p>
</div>
<div class="section" id="image-center">
<h4>Image Center<a class="headerlink" href="#image-center" title="Permalink to this headline">¶</a></h4>
<p>Since Matlab uses array-indices that start from 1, unlike most other programming
languages which count from zero, the origin of a subvolume with dimensions,
<span class="math notranslate nohighlight">\(NX, NY, NZ\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[O = (\left\lfloor{NX / 2}\right\rfloor + 1,
     \left\lfloor{NY / 2}\right\rfloor + 1,
     \left\lfloor{NZ / 2}\right\rfloor + 1)\]</div>
</div>
<div class="section" id="euler-angle-rotations">
<h4>Euler Angle Rotations<a class="headerlink" href="#euler-angle-rotations" title="Permalink to this headline">¶</a></h4>
<p>Rotations in MOTLs describe the best-found rotation of the reference to the
particle in terms of ZXZ Euler angles in degrees. The Euler angle definition in
subTOM is:</p>
<ul class="simple">
<li><p>The first rotation <em>Azimuth</em> or <em>psi</em> (<span class="math notranslate nohighlight">\(\psi\)</span>) about the Z-axis.</p></li>
<li><p>The second rotation <em>Zenith</em> or <em>theta</em> (<span class="math notranslate nohighlight">\(\theta\)</span>) about the new X-axis.</p></li>
<li><p>The final rotaiton <em>Spin</em> or <em>phi</em> (<span class="math notranslate nohighlight">\(\phi\)</span>) about the final Z-axis.</p></li>
</ul>
<p>This is particularly confusing given that phi and psi generally are swapped in
other software packages, but is kept for historical reasons from the
TOM-toolbox. Therefore care has been taken to use the unambiguous notation
azimuth, zenith, and spin in most of the subTOM code and documentation.</p>
</div>
<div class="section" id="translations">
<h4>Translations<a class="headerlink" href="#translations" title="Permalink to this headline">¶</a></h4>
<p>Translations in MOTLs describe the best-found translation of the reference to
the particle in pixels with respect to the subvolume origin. This translation
occurs after the rotation of the reference about the subvolume origin.</p>
</div>
</div>
</div>
<div class="section" id="motive-list-specification">
<h2>Motive List Specification<a class="headerlink" href="#motive-list-specification" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 49%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Contents</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>Cross-Correlation Coefficient</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Marker Set Used from PickParticle</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Radius of tube/sphere in PickParticle</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Particle Number (Running count from 1)</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Tomogram Number (Running count from 1)</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>PickParticle Object Number (Running)</p></td>
</tr>
<tr class="row-even"><td><p>7</p></td>
<td><p>Tomogram Number (From Filename)</p></td>
</tr>
<tr class="row-odd"><td><p>8</p></td>
<td><p>X-coordinate in Tomogram (Integer)</p></td>
</tr>
<tr class="row-even"><td><p>9</p></td>
<td><p>Y-coordinate in Tomogram (Integer)</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>Z-coordinate in Tomogram (Integer)</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>X-translation AFTER rotation of Ref.</p></td>
</tr>
<tr class="row-odd"><td><p>12</p></td>
<td><p>Y-translation AFTER rotation of Ref.</p></td>
</tr>
<tr class="row-even"><td><p>13</p></td>
<td><p>Z-translation AFTER rotation of Ref.</p></td>
</tr>
<tr class="row-odd"><td><p>14</p></td>
<td><p>Not Used (X-shift BEFORE rotation)</p></td>
</tr>
<tr class="row-even"><td><p>15</p></td>
<td><p>Not Used (Y-shift BEFORE rotation)</p></td>
</tr>
<tr class="row-odd"><td><p>16</p></td>
<td><p>Not Used (Z-shift BEFORE rotation)</p></td>
</tr>
<tr class="row-even"><td><p>17</p></td>
<td><p>Spin Rotation of Ref. in Degrees</p></td>
</tr>
<tr class="row-odd"><td><p>18</p></td>
<td><p>Azimuth Rotation of Ref. in Degrees</p></td>
</tr>
<tr class="row-even"><td><p>19</p></td>
<td><p>Zenith Rotation of Ref. in Degrees</p></td>
</tr>
<tr class="row-odd"><td><p>20</p></td>
<td><p>Class Number</p></td>
</tr>
</tbody>
</table>
<div class="section" id="class-number">
<h3>Class Number<a class="headerlink" href="#class-number" title="Permalink to this headline">¶</a></h3>
<p>The class number field acts as a field for classification, but also
thresholding. Historically:</p>
<ul class="simple">
<li><p>Particles that have class number 1 are always aligned and included in the
final average.</p></li>
<li><p>Particles that have class number 2 are always aligned but are not included in
the final average.</p></li>
<li><p>Particles that have class number <span class="math notranslate nohighlight">\(\leq 0\)</span> are not aligned nor included
in the final average.</p></li>
</ul>
<p>Remaining class numbers <span class="math notranslate nohighlight">\(\gt 2\)</span> can be used in classification to identify
homogeneous subsets within a heterogeneous dataset.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial.html" class="btn btn-neutral float-right" title="Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Dustin Reed Morado

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>