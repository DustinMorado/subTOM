

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>subtom_scan_angles_exact_multiref &mdash; subTOM 1.1.3 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="subTOM: Principal Component Analysis" href="../../pca/index.html" />
    <link rel="prev" title="subtom_rand_class_motl" href="subtom_rand_class_motl.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> subTOM
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../workflow.html">Example Workflow</a></li>
</ul>
<p class="caption"><span class="caption-text">Links to Individual Script Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_alignment.html">subtom_alignment.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_average.html">subtom_average.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_cat_motls.html">subtom_cat_motls.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_clean_motl.html">subtom_clean_motl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_compare_motls.html">subtom_compare_motls.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_even_odd_motl.html">subtom_even_odd_motl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_extract_noise.html">subtom_extract_noise.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_extract_subtomograms.html">subtom_extract_subtomograms.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_maskcorrected_fsc.html">subtom_maskcorrected_fsc.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_preprocess.html">subtom_preprocess.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_random_subset_motl.html">subtom_random_subset_motl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_plot_filter.html">subtom_plot_filter.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_plot_scanned_angles.html">subtom_plot_scanned_angles.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_reconstruct.html">subtom_reconstruct.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_renumber_motl.html">subtom_renumber_motl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_rotx_motl.html">subtom_rotx_motl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_scale_motl.html">subtom_scale_motl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_scale_noisemotl.html">subtom_scale_noisemotl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_seed_positions.html">subtom_seed_positions.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_shape.html">subtom_shape.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_split_motl_by_row.html">subtom_split_motl_by_row.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_transform_motl.html">subtom_transform_motl.sh</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scripts/subtom_unclass_motl.html">subtom_unclass_motl.sh</a></li>
</ul>
<p class="caption"><span class="caption-text">Links to Individual Function Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_cat_motls.html">subtom_cat_motls.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_clean_motl.html">subtom_clean_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_compare_motls.html">subtom_compare_motls.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_even_odd_motl.html">subtom_even_odd_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_extract_noise.html">subtom_extract_noise.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_extract_subtomograms.html">subtom_extract_subtomograms.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_maskcorrected_fsc.html">subtom_maskcorrected_fsc.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_parallel_sums.html">subtom_parallel_sums.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_plot_filter.html">subtom_plot_filter.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_plot_scanned_angles.html">subtom_plot_scanned_angles.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_random_subset_motl.html">subtom_random_subset_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_renumber_motl.html">subtom_renumber_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_rotx_motl.html">subtom_rotx_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_scale_motl.html">subtom_scale_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_scan_angles_exact.html">subtom_scan_angles_exact.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_seed_positions.html">subtom_seed_positions.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_shape.html">subtom_shape.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_split_motl_by_row.html">subtom_split_motl_by_row.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_transform_motl.html">subtom_transform_motl.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_weighted_average.html">subtom_weighted_average.m</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../functions/subtom_unclass_motl.html">subtom_unclass_motl.m</a></li>
</ul>
<p class="caption"><span class="caption-text">Classification Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../general/index.html">General Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../msa/index.html">MSA</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Multireference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/subtom_multiref_alignment.html">subtom_multiref_alignment.sh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/subtom_multiref_initialize.html">subtom_multiref_initialize.sh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scripts/subtom_multiref_rand_class_motl.html">subtom_multiref_rand_class_motl.sh</a></li>
<li class="toctree-l2"><a class="reference internal" href="subtom_compare_motls_multiref.html">subtom_compare_motls_multiref.m</a></li>
<li class="toctree-l2"><a class="reference internal" href="subtom_rand_class_motl.html">subtom_rand_class_motl.m</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">subtom_scan_angles_exact_multiref.m</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../pca/index.html">PCA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../wmd/index.html">WMD</a></li>
</ul>
<p class="caption"><span class="caption-text">Analysis Documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../analysis/b_factor_by_subsets/index.html">B-Factor from Subsets</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">subTOM</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">subTOM: Multireference</a> &raquo;</li>
        
      <li>subtom_scan_angles_exact_multiref</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/classification/multireference/functions/subtom_scan_angles_exact_multiref.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="subtom-scan-angles-exact-multiref">
<h1>subtom_scan_angles_exact_multiref<a class="headerlink" href="#subtom-scan-angles-exact-multiref" title="Permalink to this headline">¶</a></h1>
<p>Align a particle batch over local search angles.</p>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="n">subtom_scan_angles_exact_multiref</span><span class="p">(</span>
    <span class="s">&#39;all_motl_fn_prefix&#39;</span><span class="p">,</span> <span class="n">all_motl_fn_prefix</span> <span class="p">(</span><span class="s">&#39;combinedmotl/allmotl&#39;</span><span class="p">),</span>
    <span class="s">&#39;ref_fn_prefix&#39;</span><span class="p">,</span> <span class="n">ref_fn_prefix</span> <span class="p">(</span><span class="s">&#39;ref/ref&#39;</span><span class="p">),</span>
    <span class="s">&#39;ptcl_fn_prefix&#39;</span><span class="p">,</span> <span class="n">ptcl_fn_prefix</span> <span class="p">(</span><span class="s">&#39;subtomograms/subtomo&#39;</span><span class="p">),</span>
    <span class="s">&#39;weight_fn_prefix&#39;</span><span class="p">,</span> <span class="n">weight_fn_prefix</span> <span class="p">(</span><span class="s">&#39;otherinputs/ampspec&#39;</span><span class="p">),</span>
    <span class="s">&#39;align_mask_fn&#39;</span><span class="p">,</span> <span class="n">align_mask_fn</span> <span class="p">(</span><span class="s">&#39;none&#39;</span><span class="p">),</span>
    <span class="s">&#39;cc_mask_fn&#39;</span><span class="p">,</span> <span class="n">cc_mask_fn</span> <span class="p">(</span><span class="s">&#39;noshift&#39;</span><span class="p">),</span>
    <span class="s">&#39;apply_weight&#39;</span><span class="p">,</span> <span class="n">apply_weight</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;apply_mask&#39;</span><span class="p">,</span> <span class="n">apply_mask</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;keep_class&#39;</span><span class="p">,</span> <span class="n">keep_class</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;psi_angle_step&#39;</span><span class="p">,</span> <span class="n">psi_angle_step</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;psi_angle_shells&#39;</span><span class="p">,</span> <span class="n">psi_angle_shells</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;phi_angle_step&#39;</span><span class="p">,</span> <span class="n">phi_angle_step</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;phi_angle_shells&#39;</span><span class="p">,</span> <span class="n">phi_angle_shells</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;high_pass_fp&#39;</span><span class="p">,</span> <span class="n">high_pass_fp</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;high_pass_sigma&#39;</span><span class="p">,</span> <span class="n">high_pass_sigma</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;low_pass_fp&#39;</span><span class="p">,</span> <span class="n">low_pass_fp</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;low_pass_sigma&#39;</span><span class="p">,</span> <span class="n">low_pass_sigma</span> <span class="p">(</span><span class="mi">0</span><span class="p">),</span>
    <span class="s">&#39;nfold&#39;</span><span class="p">,</span> <span class="n">nfold</span> <span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="s">&#39;threshold&#39;</span><span class="p">,</span> <span class="n">threshold</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
    <span class="s">&#39;iteration&#39;</span><span class="p">,</span> <span class="n">iteration</span> <span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="s">&#39;tomo_row&#39;</span><span class="p">,</span> <span class="n">tomo_row</span> <span class="p">(</span><span class="mi">7</span><span class="p">),</span>
    <span class="s">&#39;num_ali_batch&#39;</span><span class="p">,</span> <span class="n">num_ali_batch</span> <span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="s">&#39;process_idx&#39;</span><span class="p">,</span> <span class="n">process_idx</span> <span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>Aligns a batch of particles from the collective motive list with the name format
<code class="docutils literal notranslate"><span class="pre">all_motl_fn_prefix</span></code> _#.em where # is the number <code class="docutils literal notranslate"><span class="pre">iteration</span></code>. The motive
list is split into <code class="docutils literal notranslate"><span class="pre">num_ali_batch</span></code> chunks and the specific chunk to process is
specified by <code class="docutils literal notranslate"><span class="pre">process_idx</span></code> . A motive list for the best determined alignment
parameters is written out for each batch with the name format
<code class="docutils literal notranslate"><span class="pre">ptct_motl_fn_prefix</span></code> _#_#.em where the first # is <code class="docutils literal notranslate"><span class="pre">iteration</span></code> + 1 and the
second # is the number <code class="docutils literal notranslate"><span class="pre">process_idx</span></code>.</p>
<p>Particles, with the name format <code class="docutils literal notranslate"><span class="pre">ptcl_fn_prefx</span></code> _#.em where # is the
subtomogram ID, are aligned against the reference with the name format
<code class="docutils literal notranslate"><span class="pre">ref_fn_prefix</span></code> _#.em where # is <code class="docutils literal notranslate"><span class="pre">iteration</span></code>. Before the comparison is made
a number of alterations are made to both the particle and reference:</p>
<blockquote>
<div><ul>
<li><p>If <code class="docutils literal notranslate"><span class="pre">nfold</span></code> is greater than 1 then C#-symmetry is applied along the
Z-axis to the reference where # is <code class="docutils literal notranslate"><span class="pre">nfold</span></code>.</p></li>
<li><p>The reference is masked in real space with the mask <code class="docutils literal notranslate"><span class="pre">align_mask_fn</span></code>, and
if <code class="docutils literal notranslate"><span class="pre">apply_mask</span></code> evaluates to true as a boolean, then this mask is also
applied to the particle. A sphere mask is applied to the particle to
reduces the artifacts caused by the box-edges on the comparison. This
sphere has a diameter that is 80% the box size and falls of with a sigma
that is 15% half the box size.</p>
<blockquote>
<div><ul class="simple">
<li><p>The mask is rotated and shifted with the currently existing alignment
parameters for the particle as to best center the mask on the particle
density.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">apply_mask</span></code> can help alignment and suppress alignment to other
features when the particle is well-centered or already reasonably well
aligned, but if this is not the case there is the risk that a tight
alignment will cutoff parts of the particle.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Both the particle and the reference are bandpass filtered in the Fourier
domain defined by <code class="docutils literal notranslate"><span class="pre">high_pass_fp</span></code>, <code class="docutils literal notranslate"><span class="pre">high_pass_sigma</span></code>, <code class="docutils literal notranslate"><span class="pre">low_pass_fp</span></code>,
and <code class="docutils literal notranslate"><span class="pre">low_pass_sigma</span></code> which are all in the units of Fourier pixels.</p></li>
<li><p>A Fourier weight volume with the name format <code class="docutils literal notranslate"><span class="pre">weight_fn_prefix</span></code> _#.em
where # corresponds to the tomogram from which the particle came from,
which is found from the field <code class="docutils literal notranslate"><span class="pre">tomo_row</span></code> in the motive list, is applied
to the reference in the Fourier domain, after the reference has been
rotated with the currently existing alignment parameters.  If
<code class="docutils literal notranslate"><span class="pre">apply_weight</span></code> evaluates to true as a boolean, then this weight is also
applied to the particle with no rotation. This Fourier weight is designed
to compensate for the missing wedge.</p>
<blockquote>
<div><ul class="simple">
<li><p>If a binary wedge is used, then it is reasonable to apply the weight
to the particle, however, for more complicated weights, like the
average amplitude spectrum, it should not be done.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
<p>The local rotations searched during alignment are deteremined by the four
parameters <code class="docutils literal notranslate"><span class="pre">psi_angle_step</span></code>, <code class="docutils literal notranslate"><span class="pre">psi_angle_shells</span></code>, <code class="docutils literal notranslate"><span class="pre">phi_angle_step</span></code>, and
<code class="docutils literal notranslate"><span class="pre">phi_angle_shells</span></code>. They describe a search where the currently existing
alignment parameters for azimuth and zenith are used to define a “pole” to
search about in the ceiling of half <code class="docutils literal notranslate"><span class="pre">psi_angle_shells</span></code> cones. The change in
zenith between each cone is <code class="docutils literal notranslate"><span class="pre">psi_angle_step</span></code> and the azimuth around the cone
is close to the same angle but is adjusted slightly to account for bias near the
pole. The final spin angle of the search is done with a change in spin of
<code class="docutils literal notranslate"><span class="pre">phi_angle_step</span></code> in <code class="docutils literal notranslate"><span class="pre">phi_angle_shells</span></code> steps. The spin is applied in both
clockwise and counter-clockwise fashion.</p>
<blockquote>
<div><ul class="simple">
<li><p>The angles phi, and psi here are flipped in their sense of every other
package for EM image processing, which is absolutely infuriating and
confusing, but maintained for historical reasons, however most
descriptions use the words azimuth, zenith, and spin to avoid ambiguity.</p></li>
</ul>
</div></blockquote>
<p>Finally after the constrained cross-correlation function is calculated it is
masked with <code class="docutils literal notranslate"><span class="pre">cc_mask_fn</span></code> to limit the shifts to inside this volume, and a peak
is found and it’s location is determined to sub-pixel accuracy using
interpolation. The rotations and shifts that gives the highest cross-correlation
coefficient are then chosen as the new alignments parameters. Particles with a
coefficient lower than <code class="docutils literal notranslate"><span class="pre">threshold</span></code> are placed into class 2 and ignored in
later processing, and particles with class <code class="docutils literal notranslate"><span class="pre">iclass</span></code> are the only particles
processed.</p>
<blockquote>
<div><ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">iclass</span></code> is 0 all particles will be considered, and particles above
<code class="docutils literal notranslate"><span class="pre">threshold</span></code> will be assigned to iclass of 1 and particles below
<code class="docutils literal notranslate"><span class="pre">threshold</span></code> will be assigned to iclass of 2. If <code class="docutils literal notranslate"><span class="pre">iclass</span></code> is 1 or 2
then particles with iclass 0 will be skipped, particles of iclass 1 and 2
will be aligned and particles with scores above <code class="docutils literal notranslate"><span class="pre">threshold</span></code> will be
assigned to iclass 1 and particles with scores below <code class="docutils literal notranslate"><span class="pre">threshold</span></code> will be
assigned to iclass 2. <code class="docutils literal notranslate"><span class="pre">iclass</span></code> of 2 does not make much sense but is set
this way in case of user mistakes or misunderstandings. If <code class="docutils literal notranslate"><span class="pre">iclass</span></code> is
greater than 2 then particles with iclass of 1, 2, and <code class="docutils literal notranslate"><span class="pre">iclass</span></code> will be
aligned, and particles with a score above <code class="docutils literal notranslate"><span class="pre">threshold</span></code> will maintain
their iclass if it is 1 or <code class="docutils literal notranslate"><span class="pre">iclass</span></code>, and particles with a previous
iclass of 2 will be upgraded to an iclass of 1. Particles with a score
below <code class="docutils literal notranslate"><span class="pre">threshold</span></code> will be assigned to iclass 2.</p></li>
<li><p>The class number is stored in the 20th field of the motive list.</p></li>
</ul>
</div></blockquote>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-Matlab notranslate"><div class="highlight"><pre><span></span><span class="n">subtom_scan_angles_multiref</span><span class="p">(</span><span class="c">...</span>
    <span class="s">&#39;all_motl_fn_prefix&#39;</span><span class="p">,</span> <span class="s">&#39;combinedmotl/allmotl&#39;</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;ref_fn_prefix&#39;</span><span class="p">,</span> <span class="s">&#39;ref/ref&#39;</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;ptcl_fn_prefix&#39;</span><span class="p">,</span> <span class="s">&#39;subtomograms/subtomo&#39;</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;weight_fn_prefix&#39;</span><span class="p">,</span> <span class="s">&#39;otherinputs/ampspec&#39;</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;align_mask_fn&#39;</span><span class="p">,</span> <span class="s">&#39;otherinputs/align_mask.em&#39;</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;cc_mask_fn&#39;</span><span class="p">,</span> <span class="s">&#39;otherinputs/cc_mask.em&#39;</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;apply_weight&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;apply_mask&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;keep_class&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;psi_angle_step&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;psi_angle_shells&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;phi_angle_step&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;phi_angle_shells&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;high_pass_fp&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;high_pass_sigma&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;low_pass_fp&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;low_pass_sigma&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;nfold&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;threshold&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;iteration&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;tomo_row&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;num_ali_batch&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="c">...</span>
    <span class="s">&#39;process_idx&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="subtom_compare_motls_multiref.html"><span class="doc">subtom_compare_motls_multiref</span></a></p></li>
<li><p><a class="reference internal" href="subtom_rand_class_motl.html"><span class="doc">subtom_rand_class_motl</span></a></p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../pca/index.html" class="btn btn-neutral float-right" title="subTOM: Principal Component Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="subtom_rand_class_motl.html" class="btn btn-neutral float-left" title="subtom_rand_class_motl" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Dustin Reed Morado

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>